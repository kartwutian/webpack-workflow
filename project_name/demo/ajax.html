<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>跨域测试</title>
</head>
<body>
 <!--  <textarea name="ajax" id="test-response-text" cols="30" rows="10"></textarea> -->
  <p id="test-jsonp"></p>
  <script>
    function getPrice() {
      var
        js = document.createElement('script'),
        head = document.getElementsByTagName('head')[0];
        js.src = 'http://api.money.126.net/data/feed/0000001,1399001?callback=refreshPrice';
        head.appendChild(js);
    }

    getPrice();

    function refreshPrice(data) {
      console.log(data);
      var p = document.getElementById('test-jsonp');
      p.innerHTML = '当前价格：' +
          data['0000001'].name +': ' + 
          data['0000001'].price + '；' +
          data['1399001'].name + ': ' +
          data['1399001'].price;
    }
    refreshPrice();

    // function success(text) {
    //   var textarea = document.getElementById('test-response-text');
    //   textarea.value = text;
    // }

    // function fail(code) {
    //   var textarea = document.getElementById('test-response-text');
    //   textarea.value = 'Error code: ' + code;
    //   console.log(code);
    // }

    // var request = new XMLHttpRequest(); // 新建XMLHttpRequest对象

    // request.onreadystatechange = function () { // 状态发生变化时，函数被回调
    //     if (request.readyState === 4) { // 成功完成
    //         // 判断响应结果:
    //         if (request.status === 200) {
    //             // 成功，通过responseText拿到响应的文本:
    //             return success(request.responseText);
    //         } else {
    //             // 失败，根据响应码判断失败原因:
    //             return fail(request.status);
    //         }
    //     } else {
    //         // HTTP请求还在继续...
    //     }
    // }

    // // 发送请求:
    // request.open('GET', 'http://api.money.126.net/data/feed/0000001,1399001?callback=refreshPrice');
    // request.send();

    // alert('请求已发送，请等待响应...');

  </script>
</body>
</html>